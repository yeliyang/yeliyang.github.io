<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--Description-->
    
        <meta name="description" content="ç†è®ºåŸºç¡€
softmaxå‡½æ•°åœ¨æ·±åº¦å­¦ä¹ é¢†åŸŸåº”ç”¨éå¸¸å¹¿ï¼Œä¸è®ºæ˜¯å·ç§¯ç¥ç»ç½‘ç»œCNNåœ¨åšå›¾åƒåˆ†ç±»æ—¶ï¼Œè¿˜æ˜¯å¾ªç¯ç¥ç»ç½‘ç»œåœ¨è‡ªç„¶è¯­è¨€å¤„ç†æ–¹å‘ä¸ºæ–‡ç« åˆ†ç±»ï¼Œåˆæˆ–è€…æ˜¯åœ¨æ¨èç³»ç»Ÿæ–¹å‘ä¸Šçš„å¬å›ï¼Œéƒ½éœ€è¦åœ¨è¾“å‡ºå±‚ä¹‹å‰è¦åŠ ä¸€å±‚softmaxï¼Œä½œç”¨å°±æ˜¯ä¸ºäº†å°†éšè—å±‚çš„è¾“å‡ºè½¬åŒ–ä¸ºä¸€ä¸ªç›¸å½“äºè¾“å‡ºä¸ªæ•°ä¸ºæ ‡ç­¾ç±»åˆ«æ•°çš„æ¦‚ç‡å€¼ã€‚softmax">
    

    <!--Author-->
    
        <meta name="author" content="Liyang Ye">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="softmaxå›å½’"/>
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Liyang&#39;s Blog"/>

    <!--Page Cover-->
    
        <meta property="og:image" content=""/>
    

    <!-- Title -->
    
    <title>softmaxå›å½’ - Liyang&#39;s Blog</title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/sass/main.css">


    <!--[if lt IE 8]>
        
<script src="/js/ie/html5shiv.js"></script>

    <![endif]-->

    <!--[if lt IE 8]>
        
<link rel="stylesheet" href="/sass/ie8.css">

    <![endif]-->

    <!--[if lt IE 9]>
        
<link rel="stylesheet" href="/sass/ie9.css">

    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


<meta name="generator" content="Hexo 5.3.0"></head>

<body>

    <div id="wrapper">

        <!-- Menu -->
        <!-- Header -->
<header id="header">
    <div class="inner">

        <!-- Logo -->
        <a href="/" class="logo">
            <span class="symbol"><img src="/images/logo.svg" alt="" /></span><span class="title">Liyang's Blog</span>
        </a>

        <!-- Nav -->
        <nav>
            <ul>
                <li><a href="#menu">Menu</a></li>
            </ul>
        </nav>

    </div>
</header>

<!-- Menu -->
<nav id="menu">
    <h2>Menu</h2>
    <ul>
        
            <li>
                <a href="/">Home</a>
            </li>
        
            <li>
                <a href="/archives">Archives</a>
            </li>
        
            <li>
                <a href="/about.html">About</a>
            </li>
        
    </ul>
</nav>


        <div id="main">
            <div class="inner">

                <!-- Main Content -->
                

    <h1 class="title">softmaxå›å½’</h1>
    <div class="meta">
        
        
            <span class="post-count">
           å­—æ•°:
            <a href="">2.7kå­— |</a>  
            </span>
        
        
            <span class="post-count">
           èŠ±è´¹æ—¶é—´:
            <a href="">11min |</a>  
            </span>
        
	<span class="post-count">å‘å¸ƒäº:2021-01-15</span>
    </div>


<!-- Tags -->


<div class="tags">
    <a href="/tags/softmax/" class="button small">softmax</a> <a href="/tags/MXNET/" class="button small">MXNET</a> <a href="/tags/äº¤å‰ç†µ/" class="button small">äº¤å‰ç†µ</a>
</div>




    <span class="image main"><img src="/images/softmax.jpg" alt="" /></span>


<!-- Gallery -->


<!-- Content -->



<h1 id="ç†è®ºåŸºç¡€">ç†è®ºåŸºç¡€</h1>
<p>softmaxå‡½æ•°åœ¨æ·±åº¦å­¦ä¹ é¢†åŸŸåº”ç”¨éå¸¸å¹¿ï¼Œä¸è®ºæ˜¯å·ç§¯ç¥ç»ç½‘ç»œCNNåœ¨åšå›¾åƒåˆ†ç±»æ—¶ï¼Œè¿˜æ˜¯å¾ªç¯ç¥ç»ç½‘ç»œåœ¨è‡ªç„¶è¯­è¨€å¤„ç†æ–¹å‘ä¸ºæ–‡ç« åˆ†ç±»ï¼Œåˆæˆ–è€…æ˜¯åœ¨æ¨èç³»ç»Ÿæ–¹å‘ä¸Šçš„å¬å›ï¼Œéƒ½éœ€è¦åœ¨è¾“å‡ºå±‚ä¹‹å‰è¦åŠ ä¸€å±‚softmaxï¼Œä½œç”¨å°±æ˜¯ä¸ºäº†å°†éšè—å±‚çš„è¾“å‡ºè½¬åŒ–ä¸ºä¸€ä¸ªç›¸å½“äºè¾“å‡ºä¸ªæ•°ä¸ºæ ‡ç­¾ç±»åˆ«æ•°çš„æ¦‚ç‡å€¼ã€‚softmaxå¯ä»¥å¾ˆå¥½çš„é’ˆå¯¹ç¦»æ•£å€¼è¿›è¡Œè®­ç»ƒåŠé¢„æµ‹ã€‚</p>
<p>softmaxå›å½’åŒçº¿æ€§å›å½’ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå•å±‚ç¥ç»ç½‘ç»œã€‚ç”±äºæ¯ä¸ªè¾“å‡ºğ‘œ1,ğ‘œ2,ğ‘œ3çš„è®¡ç®—éƒ½è¦ä¾èµ–äºæ‰€æœ‰çš„è¾“å…¥ğ‘¥1,ğ‘¥2,ğ‘¥3,ğ‘¥4x1,x2,x3,x4ï¼Œsoftmaxå›å½’çš„è¾“å‡ºå±‚ä¹Ÿæ˜¯ä¸€ä¸ªå…¨è¿æ¥å±‚ã€‚</p>
<p><img src="/images/softmaxreg.svg" /></p>
<p>å¦‚æœç›´æ¥ä½¿ç”¨è¾“å‡ºå±‚çš„è¾“å‡ºæœ‰ä¸¤ä¸ªé—®é¢˜ã€‚ä¸€æ–¹é¢ï¼Œç”±äº<strong>è¾“å‡ºå±‚çš„è¾“å‡ºå€¼çš„èŒƒå›´ä¸ç¡®å®š</strong>ï¼Œæˆ‘ä»¬éš¾ä»¥ç›´è§‚ä¸Šåˆ¤æ–­è¿™äº›å€¼çš„æ„ä¹‰ã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äº<strong>çœŸå®æ ‡ç­¾æ˜¯ç¦»æ•£å€¼</strong>ï¼Œè¿™äº›ç¦»æ•£å€¼ä¸ä¸ç¡®å®šèŒƒå›´çš„è¾“å‡ºå€¼ä¹‹é—´çš„<strong>è¯¯å·®éš¾ä»¥è¡¡é‡</strong>ã€‚</p>
<p>softmaxè¿ç®—ç¬¦ï¼ˆsoftmax operatorï¼‰è§£å†³äº†ä»¥ä¸Šä¸¤ä¸ªé—®é¢˜ã€‚å®ƒé€šè¿‡ä¸‹å¼å°†è¾“å‡ºå€¼å˜æ¢æˆå€¼ä¸ºæ­£ä¸”å’Œä¸º1çš„æ¦‚ç‡åˆ†å¸ƒï¼š <span class="math display">\[
\hat{y}_1, \hat{y}_2, \hat{y}_3 = \text{softmax}(o_1, o_2, o_3),
\]</span> å…¶ä¸­ <span class="math display">\[
\hat{y}_1 = \frac{ \exp(o_1)}{\sum_{i=1}^3 \exp(o_i)},\quad
\hat{y}_2 = \frac{ \exp(o_2)}{\sum_{i=1}^3 \exp(o_i)},\quad
\hat{y}_3 = \frac{ \exp(o_3)}{\sum_{i=1}^3 \exp(o_i)}.
\]</span></p>
<p>å®¹æ˜“çœ‹å‡ºğ‘¦Ì‚1+ğ‘¦Ì‚2+ğ‘¦Ì‚3=1ä¸”0â‰¤ğ‘¦Ì‚1,ğ‘¦Ì‚2,ğ‘¦Ì‚3â‰¤1ï¼Œå› æ­¤ğ‘¦Ì‚1,ğ‘¦Ì‚2,ğ‘¦Ì‚3æ˜¯ä¸€ä¸ªåˆæ³•çš„æ¦‚ç‡åˆ†å¸ƒã€‚è¿™æ—¶å€™ï¼Œå¦‚æœğ‘¦Ì‚2=0.8ï¼Œä¸ç®¡ğ‘¦Ì‚1å’Œğ‘¦Ì‚3çš„å€¼æ˜¯å¤šå°‘ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“å›¾åƒç±»åˆ«ä¸ºçŒ«çš„æ¦‚ç‡æ˜¯80%ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æ³¨æ„åˆ° <span class="math inline">\(\operatorname*{argmax}_i o_i = \operatorname*{argmax}_i \hat y_iï¼Œ\)</span>å› æ­¤<strong>softmaxè¿ç®—ä¸æ”¹å˜é¢„æµ‹ç±»åˆ«è¾“å‡º</strong>ã€‚</p>
<h2 id="softmaxçŸ¢é‡è®¡ç®—">softmaxçŸ¢é‡è®¡ç®—</h2>
<p><span class="math display">\[
\begin{aligned}
\boldsymbol{O} &amp;= \boldsymbol{X} \boldsymbol{W} + \boldsymbol{b},\\
\boldsymbol{\hat{Y}} &amp;= \text{softmax}(\boldsymbol{O}),
\end{aligned}
\]</span></p>
<h2 id="äº¤å‰ç†µæŸå¤±å‡½æ•°">äº¤å‰ç†µæŸå¤±å‡½æ•°</h2>
<p>æˆ‘ä»¬å¯ä»¥åƒçº¿æ€§å›å½’é‚£æ ·ä½¿ç”¨å¹³æ–¹æŸå¤±å‡½æ•°â€–ğ’šÌ‚(ğ‘–)âˆ’ğ’š(ğ‘–)â€–2/2ã€‚ç„¶è€Œï¼Œæƒ³è¦é¢„æµ‹åˆ†ç±»ç»“æœæ­£ç¡®ï¼Œæˆ‘ä»¬å…¶å®<strong>å¹¶ä¸éœ€è¦é¢„æµ‹æ¦‚ç‡å®Œå…¨ç­‰äºæ ‡ç­¾æ¦‚ç‡</strong>ã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾åƒåˆ†ç±»çš„ä¾‹å­é‡Œï¼Œå¦‚æœğ‘¦(ğ‘–)=3ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦ğ‘¦Ì‚(ğ‘–)3æ¯”å…¶ä»–ä¸¤ä¸ªé¢„æµ‹å€¼ğ‘¦Ì‚(ğ‘–)1å’Œğ‘¦Ì‚(ğ‘–)2å¤§å°±è¡Œäº†ã€‚å³ä½¿ğ‘¦Ì‚(ğ‘–)3å€¼ä¸º0.6ï¼Œä¸ç®¡å…¶ä»–ä¸¤ä¸ªé¢„æµ‹å€¼ä¸ºå¤šå°‘ï¼Œç±»åˆ«é¢„æµ‹å‡æ­£ç¡®ã€‚è€Œ<strong>å¹³æ–¹æŸå¤±åˆ™è¿‡äºä¸¥æ ¼</strong>ï¼Œä¾‹å¦‚ğ‘¦Ì‚(ğ‘–)1=ğ‘¦Ì‚(ğ‘–)2=0.2æ¯”ğ‘¦Ì‚(ğ‘–)1=0,ğ‘¦Ì‚(ğ‘–)2=0.4çš„æŸå¤±è¦å°å¾ˆå¤šï¼Œè™½ç„¶ä¸¤è€…éƒ½æœ‰åŒæ ·æ­£ç¡®çš„åˆ†ç±»é¢„æµ‹ç»“æœã€‚</p>
<p>æ”¹å–„ä¸Šè¿°é—®é¢˜çš„ä¸€ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨æ›´é€‚åˆè¡¡é‡ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒå·®å¼‚çš„æµ‹é‡å‡½æ•°ã€‚å…¶ä¸­ï¼Œäº¤å‰ç†µï¼ˆcross entropyï¼‰æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„è¡¡é‡æ–¹æ³•ï¼š <span class="math display">\[
\ell(\boldsymbol{\Theta}) = \frac{1}{n} \sum_{i=1}^n H\left(\boldsymbol y^{(i)}, \boldsymbol {\hat y}^{(i)}\right )
\]</span> äº¤å‰ç†µåªå…³å¿ƒå¯¹æ­£ç¡®ç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡ï¼Œå› ä¸ºåªè¦å…¶å€¼è¶³å¤Ÿå¤§ï¼Œå°±å¯ä»¥ç¡®ä¿åˆ†ç±»ç»“æœæ­£ç¡®ã€‚å½“ç„¶ï¼Œé‡åˆ°ä¸€ä¸ªæ ·æœ¬æœ‰å¤šä¸ªæ ‡ç­¾æ—¶ï¼Œä¾‹å¦‚å›¾åƒé‡Œå«æœ‰ä¸æ­¢ä¸€ä¸ªç‰©ä½“æ—¶ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½åšè¿™ä¸€æ­¥ç®€åŒ–ã€‚ä½†å³ä¾¿å¯¹äºè¿™ç§æƒ…å†µï¼Œäº¤å‰ç†µåŒæ ·åªå…³å¿ƒå¯¹å›¾åƒä¸­å‡ºç°çš„ç‰©ä½“ç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡ã€‚</p>
<p>å‡è®¾è®­ç»ƒæ•°æ®é›†çš„æ ·æœ¬æ•°ä¸º<span class="math inline">\(n\)</span>ï¼Œäº¤å‰ç†µæŸå¤±å‡½æ•°å®šä¹‰ä¸º <span class="math display">\[
\ell(\boldsymbol{\Theta}) = \frac{1}{n} \sum_{i=1}^n H\left(\boldsymbol y^{(i)}, \boldsymbol {\hat y}^{(i)}\right )
\]</span> å…¶ä¸­<span class="math inline">\(\boldsymbol{\Theta}\)</span>ä»£è¡¨æ¨¡å‹å‚æ•°ã€‚åŒæ ·åœ°ï¼Œå¦‚æœæ¯ä¸ªæ ·æœ¬åªæœ‰ä¸€ä¸ªæ ‡ç­¾ï¼Œé‚£ä¹ˆäº¤å‰ç†µæŸå¤±å¯ä»¥ç®€å†™æˆ<span class="math inline">\(\ell(\boldsymbol{\Theta}) = -(1/n) \sum_{i=1}^n \log \hat y_{y^{(i)}}^{(i)}\)</span>ã€‚ä»å¦ä¸€ä¸ªè§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬çŸ¥é“æœ€å°åŒ–<span class="math inline">\(\ell(\boldsymbol{\Theta})\)</span>ç­‰ä»·äºæœ€å¤§åŒ–<span class="math inline">\(\exp(-n\ell(\boldsymbol{\Theta}))=\prod_{i=1}^n \hat y_{y^{(i)}}^{(i)}\)</span>ï¼Œå³<strong>æœ€å°åŒ–äº¤å‰ç†µæŸå¤±å‡½æ•°ç­‰ä»·äºæœ€å¤§åŒ–è®­ç»ƒæ•°æ®é›†æ‰€æœ‰æ ‡ç­¾ç±»åˆ«çš„è”åˆé¢„æµ‹æ¦‚ç‡</strong>ã€‚</p>
<h1 id="ä»£ç å®è·µ">ä»£ç å®è·µ</h1>
<p>é¦–å…ˆå¯¼å…¥æœ¬èŠ‚å®ç°æ‰€éœ€çš„åŒ…æˆ–æ¨¡å—ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> d2lzh <span class="keyword">as</span> d2l</span><br><span class="line"><span class="keyword">from</span> mxnet <span class="keyword">import</span> autograd, nd</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ä½¿ç”¨Fashion-MNISTæ•°æ®é›†ï¼Œå¹¶è®¾ç½®æ‰¹é‡å¤§å°ä¸º256ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">batch_size = <span class="number">256</span></span><br><span class="line">train_iter, test_iter = d2l.load_data_fashion_mnist(batch_size)</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°†ä½¿ç”¨å‘é‡è¡¨ç¤ºæ¯ä¸ªæ ·æœ¬ã€‚å·²çŸ¥æ¯ä¸ªæ ·æœ¬è¾“å…¥æ˜¯é«˜å’Œå®½å‡ä¸º28åƒç´ çš„å›¾åƒã€‚æ¨¡å‹çš„è¾“å…¥å‘é‡çš„é•¿åº¦æ˜¯28Ã—28=784ï¼šè¯¥å‘é‡çš„æ¯ä¸ªå…ƒç´ å¯¹åº”å›¾åƒä¸­æ¯ä¸ªåƒç´ ã€‚ç”±äºå›¾åƒæœ‰10ä¸ªç±»åˆ«ï¼Œå•å±‚ç¥ç»ç½‘ç»œè¾“å‡ºå±‚çš„è¾“å‡ºä¸ªæ•°ä¸º10ï¼Œå› æ­¤softmaxå›å½’çš„æƒé‡å’Œåå·®å‚æ•°åˆ†åˆ«ä¸º784Ã—10å’Œ1Ã—10çš„çŸ©é˜µã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">num_inputs = <span class="number">784</span></span><br><span class="line">num_outputs = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">W = nd.random.normal(scale=<span class="number">0.01</span>, shape=(num_inputs, num_outputs))</span><br><span class="line">b = nd.zeros(num_outputs)</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ä¸ºæ¨¡å‹å‚æ•°é™„ä¸Šæ¢¯åº¦ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">W.attach_grad()</span><br><span class="line">b.attach_grad()</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥åªå¯¹å…¶ä¸­åŒä¸€åˆ—ï¼ˆ<code>axis=0</code>ï¼‰æˆ–åŒä¸€è¡Œï¼ˆ<code>axis=1</code>ï¼‰çš„å…ƒç´ æ±‚å’Œï¼Œå¹¶åœ¨ç»“æœä¸­ä¿ç•™è¡Œå’Œåˆ—è¿™ä¸¤ä¸ªç»´åº¦ï¼ˆ<code>keepdims=True</code>ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X = nd.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line">X.<span class="built_in">sum</span>(axis=<span class="number">0</span>, keepdims=<span class="literal">True</span>), X.<span class="built_in">sum</span>(axis=<span class="number">1</span>, keepdims=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(</span><br><span class="line"> [[5. 7. 9.]]</span><br><span class="line"> &lt;NDArray 1x3 @cpu(0)&gt;,</span><br><span class="line"> </span><br><span class="line"> [[ 6.]</span><br><span class="line">  [15.]]</span><br><span class="line"> &lt;NDArray 2x1 @cpu(0)&gt;)</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æˆ‘ä»¬å°±å¯ä»¥å®šä¹‰å‰é¢å°èŠ‚é‡Œä»‹ç»çš„softmaxè¿ç®—äº†ã€‚åœ¨ä¸‹é¢çš„å‡½æ•°ä¸­ï¼ŒçŸ©é˜µ<code>X</code>çš„è¡Œæ•°æ˜¯æ ·æœ¬æ•°ï¼Œåˆ—æ•°æ˜¯è¾“å‡ºä¸ªæ•°ã€‚ä¸ºäº†è¡¨è¾¾æ ·æœ¬é¢„æµ‹å„ä¸ªè¾“å‡ºçš„æ¦‚ç‡ï¼Œsoftmaxè¿ç®—ä¼šå…ˆé€šè¿‡<code>exp</code>å‡½æ•°å¯¹æ¯ä¸ªå…ƒç´ åšæŒ‡æ•°è¿ç®—ï¼Œå†å¯¹<code>exp</code>çŸ©é˜µåŒè¡Œå…ƒç´ æ±‚å’Œï¼Œæœ€åä»¤çŸ©é˜µæ¯è¡Œå„å…ƒç´ ä¸è¯¥è¡Œå…ƒç´ ä¹‹å’Œç›¸é™¤ã€‚è¿™æ ·ä¸€æ¥ï¼Œæœ€ç»ˆå¾—åˆ°çš„çŸ©é˜µæ¯è¡Œå…ƒç´ å’Œä¸º1ä¸”éè´Ÿã€‚å› æ­¤ï¼Œè¯¥çŸ©é˜µæ¯è¡Œéƒ½æ˜¯åˆæ³•çš„æ¦‚ç‡åˆ†å¸ƒã€‚softmaxè¿ç®—çš„è¾“å‡ºçŸ©é˜µä¸­çš„<strong>ä»»æ„ä¸€è¡Œå…ƒç´ ä»£è¡¨äº†ä¸€ä¸ªæ ·æœ¬åœ¨å„ä¸ªè¾“å‡ºç±»åˆ«ä¸Šçš„é¢„æµ‹æ¦‚ç‡</strong>ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">softmax</span>(<span class="params">X</span>):</span></span><br><span class="line">    X_exp = X.exp()</span><br><span class="line">    partition = X_exp.<span class="built_in">sum</span>(axis=<span class="number">1</span>, keepdims=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> X_exp / partition  <span class="comment"># è¿™é‡Œåº”ç”¨äº†å¹¿æ’­æœºåˆ¶</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºéšæœºè¾“å…¥ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªå…ƒç´ å˜æˆäº†éè´Ÿæ•°ï¼Œä¸”æ¯ä¸€è¡Œå’Œä¸º1ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">X = nd.random.normal(shape=(<span class="number">2</span>, <span class="number">5</span>))</span><br><span class="line">X_prob = softmax(X)</span><br><span class="line">X_prob, X_prob.<span class="built_in">sum</span>(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>(
 [[0.6264712  0.126293   0.01826552 0.10885343 0.12011679]
  [0.25569436 0.2917251  0.0754655  0.3024068  0.07470828]]
 &lt;NDArray 2x5 @cpu(0)&gt;,
 
 [0.99999994 1.        ]
 &lt;NDArray 2 @cpu(0)&gt;)</code></pre>
<h2 id="å®šä¹‰æ¨¡å‹">å®šä¹‰æ¨¡å‹</h2>
<p>æœ‰äº†softmaxè¿ç®—ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸ŠèŠ‚æè¿°çš„softmaxå›å½’æ¨¡å‹äº†ã€‚è¿™é‡Œé€šè¿‡<code>reshape</code>å‡½æ•°å°†æ¯å¼ åŸå§‹å›¾åƒæ”¹æˆé•¿åº¦ä¸º<code>num_inputs</code>çš„å‘é‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">net</span>(<span class="params">X</span>):</span></span><br><span class="line">    <span class="keyword">return</span> softmax(nd.dot(X.reshape((-<span class="number">1</span>, num_inputs)), W) + b)</span><br></pre></td></tr></table></figure>
<h2 id="å®šä¹‰æŸå¤±å‡½æ•°">å®šä¹‰æŸå¤±å‡½æ•°</h2>
<p>softmaxå›å½’ä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°ã€‚ä¸ºäº†å¾—åˆ°æ ‡ç­¾çš„é¢„æµ‹æ¦‚ç‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>pick</code>å‡½æ•°ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå˜é‡<code>y_hat</code>æ˜¯2ä¸ªæ ·æœ¬åœ¨3ä¸ªç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡ï¼Œå˜é‡<code>y</code>æ˜¯è¿™2ä¸ªæ ·æœ¬çš„æ ‡ç­¾ç±»åˆ«ã€‚é€šè¿‡ä½¿ç”¨<code>pick</code>å‡½æ•°ï¼Œæˆ‘ä»¬å¾—åˆ°äº†2ä¸ªæ ·æœ¬çš„æ ‡ç­¾çš„é¢„æµ‹æ¦‚ç‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">y_hat = nd.array([[<span class="number">0.1</span>, <span class="number">0.3</span>, <span class="number">0.6</span>], [<span class="number">0.3</span>, <span class="number">0.2</span>, <span class="number">0.5</span>]])</span><br><span class="line">y = nd.array([<span class="number">0</span>, <span class="number">2</span>], dtype=<span class="string">&#x27;int32&#x27;</span>)</span><br><span class="line">nd.pick(y_hat, y)</span><br></pre></td></tr></table></figure>
<pre><code>[0.1 0.5]
&lt;NDArray 2 @cpu(0)&gt;</code></pre>
<p>äº¤å‰ç†µæŸå¤±å‡½æ•°:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cross_entropy</span>(<span class="params">y_hat, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> -nd.pick(y_hat, y).log()</span><br></pre></td></tr></table></figure>
<h2 id="è®¡ç®—åˆ†ç±»å‡†ç¡®ç‡">è®¡ç®—åˆ†ç±»å‡†ç¡®ç‡</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">accuracy</span>(<span class="params">y_hat, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (y_hat.argmax(axis=<span class="number">1</span>) == y.astype(<span class="string">&#x27;float32&#x27;</span>)).mean().asscalar()</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç»§ç»­ä½¿ç”¨åœ¨æ¼”ç¤º<code>pick</code>å‡½æ•°æ—¶å®šä¹‰çš„å˜é‡<code>y_hat</code>å’Œ<code>y</code>ï¼Œå¹¶å°†å®ƒä»¬åˆ†åˆ«ä½œä¸ºé¢„æµ‹æ¦‚ç‡åˆ†å¸ƒå’Œæ ‡ç­¾ã€‚å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€ä¸ªæ ·æœ¬é¢„æµ‹ç±»åˆ«ä¸º2ï¼ˆè¯¥è¡Œæœ€å¤§å…ƒç´ 0.6åœ¨æœ¬è¡Œçš„ç´¢å¼•ä¸º2ï¼‰ï¼Œä¸çœŸå®æ ‡ç­¾0ä¸ä¸€è‡´ï¼›ç¬¬äºŒä¸ªæ ·æœ¬é¢„æµ‹ç±»åˆ«ä¸º2ï¼ˆè¯¥è¡Œæœ€å¤§å…ƒç´ 0.5åœ¨æœ¬è¡Œçš„ç´¢å¼•ä¸º2ï¼‰ï¼Œä¸çœŸå®æ ‡ç­¾2ä¸€è‡´ã€‚å› æ­¤ï¼Œè¿™ä¸¤ä¸ªæ ·æœ¬ä¸Šçš„åˆ†ç±»å‡†ç¡®ç‡ä¸º0.5ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">accuracy(y_hat, y) <span class="comment"># 0.5</span></span><br></pre></td></tr></table></figure>
<p>ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å¯ä»¥è¯„ä»·æ¨¡å‹<code>net</code>åœ¨æ•°æ®é›†<code>data_iter</code>ä¸Šçš„å‡†ç¡®ç‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœ¬å‡½æ•°å·²ä¿å­˜åœ¨d2lzhåŒ…ä¸­æ–¹ä¾¿ä»¥åä½¿ç”¨ã€‚è¯¥å‡½æ•°å°†è¢«é€æ­¥æ”¹è¿›ï¼šå®ƒçš„å®Œæ•´å®ç°å°†åœ¨â€œå›¾åƒå¢å¹¿â€ä¸€èŠ‚ä¸­</span></span><br><span class="line"><span class="comment"># æè¿°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">evaluate_accuracy</span>(<span class="params">data_iter, net</span>):</span></span><br><span class="line">    acc_sum, n = <span class="number">0.0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> X, y <span class="keyword">in</span> data_iter:</span><br><span class="line">        y = y.astype(<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line">        acc_sum += (net(X).argmax(axis=<span class="number">1</span>) == y).<span class="built_in">sum</span>().asscalar()</span><br><span class="line">        n += y.size</span><br><span class="line">    <span class="keyword">return</span> acc_sum / n</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæˆ‘ä»¬éšæœºåˆå§‹åŒ–äº†æ¨¡å‹<code>net</code>ï¼Œæ‰€ä»¥è¿™ä¸ªéšæœºæ¨¡å‹çš„å‡†ç¡®ç‡åº”è¯¥æ¥è¿‘äºç±»åˆ«ä¸ªæ•°10çš„å€’æ•°0.1ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evaluate_accuracy(test_iter, net) <span class="comment"># 0.0856</span></span><br></pre></td></tr></table></figure>
<h2 id="è®­ç»ƒæ¨¡å‹">è®­ç»ƒæ¨¡å‹</h2>
<p>æˆ‘ä»¬ä½¿ç”¨å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™æ¥ä¼˜åŒ–æ¨¡å‹çš„æŸå¤±å‡½æ•°ã€‚åœ¨è®­ç»ƒæ¨¡å‹æ—¶ï¼Œè¿­ä»£å‘¨æœŸæ•°<code>num_epochs</code>å’Œå­¦ä¹ ç‡<code>lr</code>éƒ½æ˜¯å¯ä»¥è°ƒçš„è¶…å‚æ•°ã€‚æ”¹å˜å®ƒä»¬çš„å€¼å¯èƒ½ä¼šå¾—åˆ°åˆ†ç±»æ›´å‡†ç¡®çš„æ¨¡å‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">num_epochs, lr = <span class="number">5</span>, <span class="number">0.1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ¬å‡½æ•°å·²ä¿å­˜åœ¨d2lzhåŒ…ä¸­æ–¹ä¾¿ä»¥åä½¿ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">train_ch3</span>(<span class="params">net, train_iter, test_iter, loss, num_epochs, batch_size,</span></span></span><br><span class="line"><span class="function"><span class="params">              params=<span class="literal">None</span>, lr=<span class="literal">None</span>, trainer=<span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">        train_l_sum, train_acc_sum, n = <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> X, y <span class="keyword">in</span> train_iter:</span><br><span class="line">            <span class="keyword">with</span> autograd.record():</span><br><span class="line">                y_hat = net(X)</span><br><span class="line">                l = loss(y_hat, y).<span class="built_in">sum</span>()</span><br><span class="line">            l.backward()</span><br><span class="line">            <span class="keyword">if</span> trainer <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                d2l.sgd(params, lr, batch_size)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                trainer.step(batch_size)  <span class="comment"># â€œsoftmaxå›å½’çš„ç®€æ´å®ç°â€ä¸€èŠ‚å°†ç”¨åˆ°</span></span><br><span class="line">            y = y.astype(<span class="string">&#x27;float32&#x27;</span>)</span><br><span class="line">            train_l_sum += l.asscalar()</span><br><span class="line">            train_acc_sum += (y_hat.argmax(axis=<span class="number">1</span>) == y).<span class="built_in">sum</span>().asscalar()</span><br><span class="line">            n += y.size</span><br><span class="line">        test_acc = evaluate_accuracy(test_iter, net)</span><br><span class="line">        print(<span class="string">&#x27;epoch %d, loss %.4f, train acc %.3f, test acc %.3f&#x27;</span></span><br><span class="line">              % (epoch + <span class="number">1</span>, train_l_sum / n, train_acc_sum / n, test_acc))</span><br><span class="line"></span><br><span class="line">train_ch3(net, train_iter, test_iter, cross_entropy, num_epochs, batch_size,</span><br><span class="line">          [W, b], lr)</span><br></pre></td></tr></table></figure>
<pre><code>epoch 1, loss 0.7898, train acc 0.745, test acc 0.808
epoch 2, loss 0.5736, train acc 0.811, test acc 0.818
epoch 3, loss 0.5294, train acc 0.824, test acc 0.834
epoch 4, loss 0.5055, train acc 0.830, test acc 0.837
epoch 5, loss 0.4892, train acc 0.834, test acc 0.840</code></pre>
<h2 id="é¢„æµ‹">é¢„æµ‹</h2>
<p>è®­ç»ƒå®Œæˆåï¼Œç°åœ¨å°±å¯ä»¥æ¼”ç¤ºå¦‚ä½•å¯¹å›¾åƒè¿›è¡Œåˆ†ç±»äº†ã€‚ç»™å®šä¸€ç³»åˆ—å›¾åƒï¼ˆç¬¬ä¸‰è¡Œå›¾åƒè¾“å‡ºï¼‰ï¼Œæˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹å®ƒä»¬çš„çœŸå®æ ‡ç­¾ï¼ˆç¬¬ä¸€è¡Œæ–‡æœ¬è¾“å‡ºï¼‰å’Œæ¨¡å‹é¢„æµ‹ç»“æœï¼ˆç¬¬äºŒè¡Œæ–‡æœ¬è¾“å‡ºï¼‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> X, y <span class="keyword">in</span> test_iter:</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">true_labels = d2l.get_fashion_mnist_labels(y.asnumpy())</span><br><span class="line">pred_labels = d2l.get_fashion_mnist_labels(net(X).argmax(axis=<span class="number">1</span>).asnumpy())</span><br><span class="line">titles = [true + <span class="string">&#x27;\n&#x27;</span> + pred <span class="keyword">for</span> true, pred <span class="keyword">in</span> <span class="built_in">zip</span>(true_labels, pred_labels)]</span><br><span class="line"></span><br><span class="line">d2l.show_fashion_mnist(X[<span class="number">0</span>:<span class="number">9</span>], titles[<span class="number">0</span>:<span class="number">9</span>])</span><br></pre></td></tr></table></figure>
<p><img src="/images/output_31_0.svg" /></p>
<h1 id="ç®€æ´å®ç°">ç®€æ´å®ç°</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> d2lzh <span class="keyword">as</span> d2l</span><br><span class="line"><span class="keyword">from</span> mxnet <span class="keyword">import</span> gluon, init</span><br><span class="line"><span class="keyword">from</span> mxnet.gluon <span class="keyword">import</span> loss <span class="keyword">as</span> gloss, nn</span><br><span class="line"></span><br><span class="line">batch_size = <span class="number">256</span></span><br><span class="line">train_iter, test_iter = d2l.load_data_fashion_mnist(batch_size)</span><br><span class="line">net = nn.Sequential()</span><br><span class="line"><span class="comment">#è¾“å‡ºä¸ªæ•°ä¸º10çš„å…¨è¿æ¥å±‚</span></span><br><span class="line">net.add(nn.Dense(<span class="number">10</span>))</span><br><span class="line"><span class="comment">#å‡å€¼ä¸º0ã€æ ‡å‡†å·®ä¸º0.01çš„æ­£æ€åˆ†å¸ƒéšæœºåˆå§‹åŒ–æ¨¡å‹çš„æƒé‡å‚æ•°</span></span><br><span class="line">net.initialize(init.Normal(sigma=<span class="number">0.01</span>))</span><br><span class="line"><span class="comment">#åˆ†å¼€å®šä¹‰softmaxè¿ç®—å’Œäº¤å‰ç†µæŸå¤±å‡½æ•°å¯èƒ½ä¼šé€ æˆæ•°å€¼ä¸ç¨³å®š</span></span><br><span class="line">loss = gloss.SoftmaxCrossEntropyLoss()</span><br><span class="line"><span class="comment">#ä½¿ç”¨å­¦ä¹ ç‡ä¸º0.1çš„å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™sgdä½œä¸ºä¼˜åŒ–ç®—æ³•ã€‚</span></span><br><span class="line">trainer = gluon.Trainer(net.collect_params(), <span class="string">&#x27;sgd&#x27;</span>, &#123;<span class="string">&#x27;learning_rate&#x27;</span>: <span class="number">0.1</span>&#125;)</span><br><span class="line">num_epochs = <span class="number">5</span></span><br><span class="line">d2l.train_ch3(net, train_iter, test_iter, loss, num_epochs, batch_size, <span class="literal">None</span>,</span><br><span class="line">              <span class="literal">None</span>, trainer)</span><br></pre></td></tr></table></figure>
<h2 id="å°ç»“">å°ç»“</h2>
<ul>
<li>å¯ä»¥ä½¿ç”¨softmaxå›å½’åšå¤šç±»åˆ«åˆ†ç±»ã€‚ä¸è®­ç»ƒçº¿æ€§å›å½’ç›¸æ¯”ï¼Œä½ ä¼šå‘ç°è®­ç»ƒsoftmaxå›å½’çš„æ­¥éª¤å’Œå®ƒéå¸¸ç›¸ä¼¼ï¼šè·å–å¹¶è¯»å–æ•°æ®ã€å®šä¹‰æ¨¡å‹å’ŒæŸå¤±å‡½æ•°å¹¶ä½¿ç”¨ä¼˜åŒ–ç®—æ³•è®­ç»ƒæ¨¡å‹ã€‚äº‹å®ä¸Šï¼Œç»å¤§å¤šæ•°æ·±åº¦å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒéƒ½æœ‰ç€ç±»ä¼¼çš„æ­¥éª¤ã€‚</li>
</ul>



<!-- Comments -->
<div>
    
    <hr />
    <h3>Comments:</h3>
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>



</div>



    
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            processEscapes: true
          }
        });
      </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
            tex2jax: {
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
          });
      </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
              var all = MathJax.Hub.getAllJax(), i;
              for(i=0; i < all.length; i += 1) {
                  all[i].SourceElement().parentNode.className += ' has-jax';
              }
          });
      </script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>




            </div>
        </div>

        <!-- Footer -->
<footer id="footer">
    <div class="inner">
        <section>
            <h2>About</h2>
            <div>
                This blog is used to save the things that I have learnt from Machine Learning and Deep Learning.
            </div>
        </section>
        <section>
            <h2>Follow</h2>
            <ul class="icons">
                
                
                
                
                
                    <li><a href="https://github.com/yeliyang/" class="icon style2 fa-github" target="_blank" ><span class="label">GitHub</span></a></li>
                
                
                
                
                
                    <li><a href="\#" class="icon style2 fa-envelope-o" target="_blank" ><span class="label">Email</span></a></li>
                
                
                    <li><a href="\#" class="icon style2 fa-rss" target="_blank" ><span class="label">RSS</span></a></li>
                
            </ul>
        </section>
        <ul class="copyright">
            <li>&copy; Untitled. All rights reserved</li>
            <li>Design: <a href="http://html5up.net" target="_blank">HTML5 UP</a></li>
            <li>Hexo: <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></li>
        </ul>
    </div>
</footer>
    </div>

    <!-- After footer scripts -->
    
<!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- skel -->

<script src="/js/skel.min.js"></script>


<!-- Custom Code -->

<script src="/js/util.js"></script>


<!--[if lte IE 8]>

<script src="/js/ie/respond.min.js"></script>

<![endif]-->

<!-- Custom Code -->

<script src="/js/main.js"></script>


<!-- Gallery -->
<script src="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'liyang';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


</body>

</html>